% xelatex -shell-escape main.tex
\documentclass[landscape, twocolumn, a4paper]{article}
\usepackage{graphicx, amssymb, amsmath, textcomp, booktabs}
\usepackage[libertine,vvarbb]{newtxmath}
\usepackage[scr=rsfso]{mathalfa}
\usepackage[T1]{fontenc} % best for Western European languages
\usepackage{minted}
\usepackage{listings, color, setspace, titlesec, fancyhdr, mdframed, multicol}
\usepackage{ucharclasses}
\usepackage{xunicode, xltxtra}
\usepackage[inner=1.35cm, outer=0.9cm, top=1.3cm, bottom=1.3cm]{geometry}
\usepackage{pdfpages}
\usepackage{tocloft}
\usepackage{nameref}
\usepackage{verbatim}
\usepackage{relsize}
\usepackage{fontspec}
\usepackage[colorlinks, linkcolor = black]{hyperref}
\usepackage[table]{xcolor}
\usepackage{tabularx}
\usepackage{xeCJK}
\usepackage{multirow}
\usepackage{svg}
\usepackage{attachfile}
\usepackage{accsupp}

\newcommand\emptyaccsupp[1]{\BeginAccSupp{ActualText={}}#1\EndAccSupp{}}
%default definition is: \def\theFancyVerbLine{\rmfamily\tiny\arabic{FancyVerbLine}}
\let\theHFancyVerbLine\theFancyVerbLine% don't apply our patch to hyperref's version
\def\theFancyVerbLine{\rmfamily\tiny\emptyaccsupp{\arabic{FancyVerbLine}}}
% configure fonts


\setCJKmainfont{SimHei}[Scale=0.8]
\setCJKmonofont{SimHei}[Scale=0.8]
\setCJKsansfont{KaiTi}[Scale=0.8]

\setmainfont{Linux Libertine O}[Scale=0.925]
\setmonofont[Path=font/]{FiraCode-Regular}[Scale=0.8]

\XeTeXlinebreaklocale "zh"
\XeTeXlinebreakskip = 0pt plus 1pt

\titlespacing*{\section}{0pt}{0\baselineskip}{0.0\baselineskip}
\titlespacing*{\subsection}{0pt}{0\baselineskip}{0.0\baselineskip}
\titlespacing*{\subsubsection}{0pt}{0\baselineskip}{0.0\baselineskip}

\setlength{\abovecaptionskip}{0pt}
\setlength{\belowcaptionskip}{0pt}

\abovedisplayshortskip=0pt
\belowdisplayshortskip=0pt
\abovedisplayskip=0pt
\belowdisplayskip=0pt

\setlength{\parskip}{0pt}

\date{}


\setminted[py]{
	style=xcode,
	mathescape,
	linenos,
	autogobble,
	baselinestretch=0.8,
	tabsize=3,
	fontsize=\normalsize,
	frame=single,
	framesep=1mm,
	framerule=0.3pt,
	numbersep=1mm,
	breaklines=true,
	breaksymbolsepleft=2pt,
	breakbytoken=false,
	showtabs=true,
	tab={\relscale{0.6} $\big\vert \ \ \ $ \relscale{1}},
}
\setminted[cpp]{
	style=xcode,
	mathescape,
	linenos,
	autogobble,
	baselinestretch=0.8,
	tabsize=3,
	fontsize=\normalsize,
	frame=single,
	framesep=1mm,
	framerule=0.3pt,
	numbersep=1mm,
	breaklines=true,
	breaksymbolsepleft=2pt,
	breakbytoken=false,
	showtabs=true,
	tab={\relscale{0.6} $\big\vert \ \ \ $ \relscale{1}},
}


\begin{document}
\begin{titlepage}
\onecolumn
\begin{figure*}[h]
	\centering
	\includegraphics[scale=0.5]{others/Peking_University_logo.png}
\end{figure*}


\begin{center}
    \includesvg{name/r.svg}
    \includesvg{name/o.svg}
    \includesvg{name/y.svg}
    \includesvg{name/g.svg}
    \includesvg{name/b.svg}
    \includesvg{name/p.svg}
\end{center}


% \vspace*{3cm}
% {\LARGE
% \centering
% \begin{tabular}{ccc@{\hspace{1.5cm}}ccc}
% \multicolumn{3}{c}{Coach} & \multicolumn{3}{c}{Contestant} \\
% 张勤建 & & 罗国杰 & 钱易 & 彭博 & 冯施源 \\
% Qinjian Zhang & & Guojie Luo & Yi Qian & Bo Peng & Shiyuan Feng \\
% \end{tabular}
% }


% \center\fontsize{20.0pt}{\baselineskip}\selectfont ICPC World Finals Luxor 

\thispagestyle{empty}
\pagebreak
\twocolumn
\end{titlepage}

\pagestyle{fancy}
    % \lhead{\large Peking University-Let it Rot}
    \rhead{\Huge \thepage}

\setcounter{tocdepth}{3}
		%\let\cleardoublepage\relax
		%\let\clearpage\relax
		\begin{small}
		\begin{spacing}{0.75}
		\tableofcontents
		\end{spacing}
		\end{small}


		\newpage
\section{图论}

\subsection{二分图匹配}
\subsubsection{二分图最大匹配 | 最小边覆盖}
左到右连单向边，时间复杂度 $O(M|match|)$。

\inputminted{cpp}{contents/graph/matching/dfs-matching.cpp}

\subsubsection{二分图最大匹配 (bitset 优化)}
左到右连单向边，时间复杂度 $O(n^2/w\ |match|)$。

\inputminted{cpp}{contents/graph/matching/bitset-dfs-matching.cpp}

\subsubsection{二分图最大匹配 (Hopcroft-Karp) \& 最小边覆盖}
左到右单向边，时间复杂度 $O(M \sqrt{|match|})$

\inputminted{cpp}{contents/graph/matching/HK.cpp}

\subsubsection{二分图最小权匹配}

返回左边每个点匹配的右边点的编号，左边的点不多于右边的点（必要时补点）。

\inputminted{cpp}{contents/graph/matching/KM.cpp}


\subsection{网络最大流 (dinic)}
\inputminted{cpp}{contents/graph/dinic.cpp}

\subsection{最小费用流}
\inputminted{cpp}{contents/graph/MCMF.cpp}

\subsection{一般图最大匹配 (带花树)}
edge 里存双向边。运行结束后 match 存放每个点匹配的点的编号，如果没有匹配则为 $0$。
\inputminted{cpp}{contents/graph/带花树.cpp}

\subsection{最小树形图}

用 DMST::link 添加边，然后调用 DMST::solve(root) 得到最小树形图边的集合，如果没有合法解会返回空集 (注意 $n=1$)。

\inputminted{cpp}{contents/graph/D-MST.cpp}

\subsection{强连通分量 (kosaraju)}

e 存有向边，re 里存反向边。用 solve 得到所有强连通分量。时间复杂度 $O(\frac{n^2}{w})$。

\inputminted{cpp}{contents/graph/kosaraju.cpp}

\subsection{欧拉回路/欧拉路径}

如果是无向图，两个方向都连边，id 相同。不同的边 id 不同且在 $[1, m]$ 里。

src 是起点，如果是欧拉路径，找一个度数为奇数(无向图)/出度大于入度(有向图)的点作为 src，如果是回路，选一个度数非零的点作为 src。

如果有解，求出路径是 $s$，那么返回 $[(s_1 = src, -1), (s_2, id(s_1 \rightarrow s_2)), \ldots, (s_n, id(s_{n-1} \rightarrow s_n))]$，如果是回路，那么 $s_n = s_1 = src$。无解则返回空集。


\inputminted{cpp}{contents/graph/eulerwalk.cpp}

% \subsection{缩点 | Tarjan} % !!! pb
% \inputminted{cpp}{contents/graph/tarjan.cpp}
% 
% \subsection{缩点 | 点双} % !!! pb
% \inputminted{cpp}{contents/graph/tarjan_vertex.cpp}
% 
% \subsection{缩点 | 边双} % !!! pb
% \inputminted{cpp}{contents/graph/tarjan_edge.cpp}
% 
% \subsection{仙人掌}
% \inputminted{cpp}{contents/graph/cactus.cpp}
% 
% \subsection{2-Sat}
% \inputminted{cpp}{contents/graph/2-sat.cpp}
% 
% \subsection{支配树}
% \inputminted{cpp}{contents/graph/支配树.cpp}
% 
% \subsection{三/四元环}
% \inputminted{cpp}{contents/graph/34cycle.cpp}
% 
% \subsection{双极定向}
% \inputminted{cpp}{contents/graph/双极定向.cpp}
\subsection{Tree And Graph}
\input{contents/graph/TreeAndGraph.tex}

% \subsection{拟阵交}
% \inputminted{cpp}{contents/graph/拟阵交.cpp}
% x

\section{数论}	

\subsection{取模还原分数}
\inputminted{cpp}{contents/numbertheory/approx.cpp}

\subsection{扩展欧几里得}
结果的 $x, y$ 满足：$ax + by = \gcd(a, b)$; 若 $a, b$ 非 $0$，则： $-b \leq x \leq b, -a \leq y \leq a$。

\inputminted{cpp}{contents/numbertheory/exgcd.cpp}

\subsection{万能欧几里得}
\inputminted{cpp}{contents/numbertheory/Euclid.cpp}

\subsection{floor-sum}
$n < 2 ^ {32}, 1 \leq m < 2 ^ {32}$

$$
result=\sum_{i=0}^{n-1} \lfloor \frac{ai + b}{m} \rfloor \pmod{2^{63}}
$$

\inputminted{cpp}{contents/numbertheory/floor_sum.cpp}

\subsection{Min of Mod of Linear}
$$
result=\min_{0 \leq i < n} \{ (a i + b) \% m \}
$$

\inputminted{cpp}{contents/numbertheory/minmod.cpp}

\subsection{Stern-Brocot Tree 二分}

\inputminted{cpp}{contents/numbertheory/sbt.cpp}

\subsection{中国剩余定理}
返回满足 $x \equiv a_i \pmod{m_i} (i = 1, 2)$ 的最小非负整数 $x$，若无解则返回 $-1$。

\inputminted{cpp}{contents/numbertheory/CRT.cpp}

\subsection{Miller-Rabin}

调用 checkprime 判断是否为质数。

\inputminted{cpp}{contents/numbertheory/Miller_Rabin.cpp}

\subsection{Pollard-rho}

调用 factor 获得 $x$ 质因子的可重集合（已从小到大排序）。

\inputminted{cpp}{contents/numbertheory/pollard_rho.cpp}

\section{Math}

\subsection{拉格朗日反演}
$$
\begin{aligned}
G(F(x))&=H(x)\Rightarrow [x^n]G(x)=\frac{1}{n}[u^{n-1}]H'(u)(\frac{u}{F(u)})^n\\
G(F(x))&=x\Rightarrow [x^n]H(G(x))=\frac{1}{n}[u^{n-1}]H'(u)(\frac{u}{F(u)})^n\\
G(F(x))&=x\Rightarrow [x^n]G^k(x)=\frac{k}{n}[u^{n-k}](\frac{u}{F(u)})^n
\end{aligned}
$$
\subsection{分拆数|五边形数}
$$
\prod_{i \ge 1} (1 - x ^ i)= \sum_{k = -\infty} ^ {\infty} (-1) ^ k x ^ {\frac{k(3k-1)}{2}}
$$


\subsection{Fast Fourier Transform}
\inputminted{cpp}{contents/math/FFT.cpp}

\subsection{Number Theoretic Transform}
\inputminted{cpp}{contents/math/NTT.cpp}

\subsection{Generating function}
\inputminted{cpp}{contents/math/GF_noExp.cpp}

\subsection{全在线卷积}
\inputminted{cpp}{contents/math/online_convolution.cpp}

\subsection{常系数线性递推}
\subsubsection{Berlekamp Massey}

返回最短的 $c$ 使得： $\forall n \geq size(c) : a_n = \sum_{i=0}^{size(c)-1} c_i a_{n-1-i}$

\inputminted{cpp}{contents/math/BM.cpp}

\subsubsection{递推式转分式}

$$
a_i = \sum_{j=1}^{d} c_j a_{i-j}, i \geq d \Leftrightarrow a_i = \left\lbrack x^i \right\rbrack \frac{p(x)}{q(x)}
$$

\inputminted{cpp}{contents/math/线性递推形式转换.cpp}
\subsubsection{Bostan–Mori}
$$ \left\lbrack x^k\right\rbrack \frac{p(x)}{q(x)} $$

\inputminted{cpp}{contents/math/bostan_mori.cpp}

\subsubsection{远处区间值}
$$ \left\lbrack x^{\left\lbrack k,k+m\right)}\right\rbrack \frac{p(x)}{q(x)}$$

如果 $deg(p) \geq deg(q)$, 请使用 solve\_x，不然可以直接使用 solve。

\inputminted{cpp}{contents/math/Fiduccia.cpp}

\subsection{线性规划 (单纯形法)}
$x[1\cdots n]$ 是变量，$a[1\cdots m][\cdots]$ 是约束。

所有约束为：
$$
\begin{aligned}
\forall i \in [1, m] &: a[i][0] + \sum_{j=1}^{n} a[i][j] x[j] \geq 0 \\
\forall j \in [1, n] &: x[j] \geq 0
\end{aligned}
$$

最大化
$$
\sum_{j=1}^{n} a[0][j] x[j]
$$

如果无解返回 nan，如果无界返回 inf。最后的 $x$ 里存放的是最优解。


\inputminted{cpp}{contents/math/LP.cpp}

\subsection{Simpson 积分}

$$
\begin{aligned}
	\int_a^b f(x) dx &\approx
	\frac{b-a}{3n} (f(x_0) + 4 \sum_{i=1}^{n/2} f(x_{2i-1}) + 2 \sum_{i=1}^{n/2-1} f(x_{2i})+f(x_n)) \\
	&\approx \frac{3(b-a)}{8n} (f(x_0) + 3 \sum_{i=1}^{n/3} (f(x_{3i-1}) + f(x_{3i-2})) + 2 \sum_{i=1}^{n/3-1} f(x_{3i})+f(x_n))
\end{aligned}
$$

\subsection{黄金三分}
返回 $f$ 在 $[min(a, c), max(a, c)]$ 上的极大值点 (f 需要是单峰函数)。
\inputminted{cpp}{contents/math/Goldensectionsearch.cpp}

\section{字符串}

\subsection{后缀自动机 SAM}
需要两倍点数量。
\inputminted{cpp}{contents/string/SAM.cpp}

\subsection{回文自动机 PAM}
\inputminted{cpp}{contents/string/PAM.cpp}

\subsection{AC 自动机}
\inputminted{cpp}{contents/string/AC自动机.cpp}

\subsection{SA}
后缀数组， $sa$ 是个 $0 \sim n-1$ 的排列，$h[i] = lcp(s[sa[i]:], s[sa[i+1]:])$。
\inputminted{cpp}{contents/string/SA.cpp}

\subsection{Z algorithm}
返回的 $lcp[i] = lcp(s, s[i:])$。
\inputminted{cpp}{contents/string/Zalgo.cpp}

\subsection{Manacher}
返回每个回文中心的回文半径大小，奇偶分开考虑。
\inputminted{cpp}{contents/string/manacher.cpp}

\subsection{最小表示法}
返回 $s$ 的最小表示的起始位置。可以用 rotate 算出最小表示的字符串。
\inputminted{cpp}{contents/string/minrep.cpp}

\subsection{Lyndon 分解}
\inputminted{cpp}{contents/string/lyndon.cpp}

\section{数据结构}
\subsection{区间加区间求和 树状数组}
add 区间加，query 区间求和。区间都是闭区间。
\inputminted{cpp}{contents/ds/ex-bit.cpp}

\subsection{zkw 线段树}
单点修改区间半群。如果半群没有单位元可以用 qry2。
\inputminted{cpp}{contents/ds/zkw-sgt.cpp}

\subsection{静态区间半群}
$O(n \log n)$ 预处理，$O(1)$ 查询。
\inputminted{cpp}{contents/ds/rangequery.cpp}

\subsection{Link Cut Tree}
\inputminted{cpp}{contents/ds/LCT.cpp}

% \subsection{FHQ Treap} % !!! pb
% \inputminted{cpp}{contents/ds/fhq.cpp}

\subsection{pbds tree}
\inputminted{cpp}{contents/ds/pbds_tree.cpp}

\section{geometry}
\subsection{向量}
\inputminted{cpp}{contents/geometry/向量.cpp}

\subsection{三角形各心}
\inputminted{cpp}{contents/geometry/centers.cpp}

\subsection{直线半平面}
\inputminted{cpp}{contents/geometry/直线半平面.cpp}

\subsection{半平面交}
\inputminted{cpp}{contents/geometry/半平面交.cpp}

\subsection{线段}
\inputminted{cpp}{contents/geometry/线段.cpp}

\subsection{多边形}
\inputminted{cpp}{contents/geometry/多边形.cpp}

\subsection{线段 in 多边形}
\inputminted{cpp}{contents/geometry/seg_in_polygon.cpp}

\subsection{图形求交}
\inputminted{cpp}{contents/geometry/图形交.cpp}

\subsection{凸包}
结果为逆时针。
\inputminted{cpp}{contents/geometry/凸包.cpp}

\subsection{上凸壳}
结果显然为顺时针。
\inputminted{cpp}{contents/geometry/上凸壳.cpp}

\subsection{最小圆覆盖}
\inputminted{cpp}{contents/geometry/最小圆覆盖.cpp}

\subsection{最近点对}
\inputminted{cpp}{contents/geometry/最近点对.cpp}

\subsection{凸包直径}
\inputminted{cpp}{contents/geometry/凸包直径.cpp}
% https://codeforces.com/blog/entry/48868?#comment-329264

\subsection{切凸包}
\inputminted{cpp}{contents/geometry/切凸包.cpp}

\subsection{V 图}
\inputminted{cpp}{contents/geometry/voronoi.cpp}

\subsection{Delaunay 三角剖分}
\inputminted{cpp}{contents/geometry/Delaunay.cpp}

\section{geometry3d}
\subsection{向量}
\inputminted{cpp}{contents/geometry/3d/vector.cpp}

\subsection{平面}
\inputminted{cpp}{contents/geometry/3d/plane.cpp}

\subsection{直线}
\inputminted{cpp}{contents/geometry/3d/line.cpp}

\subsection{凸包}
\inputminted{cpp}{contents/geometry/3d/convex.cpp}

\section{Misc}
\subsection{Pragma}
\inputminted{cpp}{contents/misc/pragma.cpp}

\subsection{Barrett}
\inputminted{cpp}{contents/misc/Barrett.cpp}

\subsection{LCS}
\inputminted{cpp}{contents/misc/lcs.cpp}

\subsection{日期公式}
getday 返回自 $1/1/1$ 起到 $y/m/d$ 的天数，$1/1/1$ 是星期一，所以模 $7$ 可以得算出是周几。

date 是 getday 的逆。

\inputminted{cpp}{contents/misc/zeller.cpp}

\subsection{Xorshift}
\inputminted{cpp}{contents/misc/xorshift.cpp}

\subsection{python}
\inputminted{py}{contents/misc/template.py}

\subsection{浮点数精度}
\inputminted{text}{contents/misc/ieee754.txt}

\section{配置}

\subsection{vimrc}
\inputminted{cpp}{contents/config/.vimrc}

\subsection{bashrc}
\inputminted{cpp}{contents/config/.bashrc}

\subsection{对拍}
需要 chmod +x
\inputminted{cpp}{contents/config/1.sh}

\subsection{编译参数}
\inputminted{text}{contents/tables/options.txt}

\subsection{随机素数}
\inputminted{text}{contents/tables/primes.txt}

\subsection{常数表}
\input{contents/tables/Addon.tex}


\section{注意事项}
\subsection{测试项目}
pbds tree,
float128, int128, long double,
submit 命令,
printfile,
MLE ?= RE,
pragma,
axv2,
python,

测试代码长度限制,尝试触发 NO-OUTPUT, OUTPUT-LIMIT, RUN-ERROR
\newline
\subsection{bugs}
看数据范围（多测总和）,
变量 shadow,
清空,
long long,
数组大小,
模数,
MLE?,
对拍记得看输出在不在变,
输出格式，
inf 开小，
答案初值，
STL 重构导致引用失效，
极端情况(n=1)
\newline
\onecolumn
\newpage

\begin{multicols}{3}
\section{tables}
\subsection{导数积分}
\input{contents/math/CalculusTable.tex}
\input{contents/math/IntegrationTable_NewMeta.tex}
\end{multicols}


\end{document}
